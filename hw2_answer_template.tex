\documentclass[12pt]{article}
\usepackage{amsmath, amssymb, amsthm, enumerate, graphicx}
\usepackage[usenames,dvipsnames]{color}
\usepackage{bm}
\usepackage[colorlinks=true,urlcolor=blue]{hyperref}
\usepackage{geometry}
\geometry{margin=1in}
\usepackage{float}
\usepackage{graphics}
\setlength{\marginparwidth}{2.15cm}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{epsfig}
\usepackage{setspace}
\usepackage{parskip}
\usepackage[normalem]{ulem}
\usepackage{tikz}
\usetikzlibrary{positioning, arrows, automata}
\usepackage{pgfplots}
\usepackage[font=scriptsize]{subcaption}
\usepackage{float}
\usepackage[]{algorithm2e}
\usepackage{environ}
\usepackage{bbm}
\usepackage{graphicx}
\usepackage{titling}
\usepackage{url}
\usepackage{xcolor}
\usepackage{lipsum}
\usepackage{lastpage}
\usepackage[colorlinks=true,urlcolor=blue]{hyperref}
\usepackage{multicol}
\usepackage{tabularx}
\usepackage{comment}
\usepackage[utf8]{inputenc}
\usepackage{amssymb}
\usepackage{setspace}
\usepackage{marvosym}
\usepackage{wrapfig}
\usepackage{datetime}
\usepackage[many]{tcolorbox}
\usepackage{array}
\usepackage{multirow}
\usepackage{wasysym}
\usepackage{cancel}

\usepackage{listings}
\usepackage{color}
\usepackage[thinlines]{easytable}


\newcommand{\R}{\mathbb{R}}
\newcommand{\blackcircle}{\tikz\draw[black,fill=black] (0,0) circle (1ex);}
\renewcommand{\circle}{\tikz\draw[black] (0,0) circle (1ex);}


%\newcommand{\norm}[1]{\lVert #1 \rVert}
%\newcommand{\st}{\mathrm{s.t.}}

\makeatletter
\newcommand{\removelatexerror}{\let\@latex@error\@gobble}
\makeatother

\newcommand{\argmax}{\mathop{\mathrm{argmax}}}
\newcommand{\argmin}{\mathop{\mathrm{argmin}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Custom box for highlights               %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Define box and box title style
\tikzstyle{mybox} = [fill=blue!10, very thick,
    rectangle, rounded corners, inner sep=1em, inner ysep=1em]

% \newcommand{\notebox}[1]{
% \begin{tikzpicture}
% \node [mybox] (box){%
%     \begin{minipage}{\textwidth}
%     #1
%     \end{minipage}
% };
% \end{tikzpicture}%
% }

\NewEnviron{notebox}{
\begin{tikzpicture}
\node [mybox] (box){
    \begin{minipage}{\textwidth}
        \BODY
    \end{minipage}
};
\end{tikzpicture}
}
\begin{document}

\section*{}
\begin{center}
  \centerline{\textsc{\LARGE  Homework 2 Template (v1, released Oct. 1st)}}
\end{center}

Enter your team's andrew IDs in the boxes below.  If you do not do this, you may lose points on your assignment.

AndrewId 1: \begin{tcolorbox}[fit,height=1cm, width=5cm, blank, borderline={1pt}{1pt},nobeforeafter]
    \begin{center}
    \vspace{3mm}
    ielshar
    \end{center}
\end{tcolorbox}
    \\
AndrewId 2: \begin{tcolorbox}[fit,height=1cm, width=5cm, blank, borderline={1pt}{1pt},nobeforeafter]
    \begin{center}
    \vspace{3mm}
    mharding
    \end{center}
\end{tcolorbox} \\
\vspace{0.5cm}

Use this template to record your answers for Homework 2.  Add your answers using LaTeX and then save your document as a pdf to upload to gradescope.  You are required to use this template to submit your answers.  \textbf{You should not alter this template in any way} other than to insert your solutions.  You must submit all 13 pages of this template to gradescope.  Do not remove the instructions page(s).  Altering this template or including your solutions outside of the provided boxes can result in your assignment being graded incorrectly.  You may lose points if you do not follow these instructions.

\section*{Instructions for Specific Problem Types}

% For ``Select One" questions, please use a ``filled in'' circle to indicate your answer:

% \begin{quote}
% \textbf{Select One:} Which of these is an instructor of this course?
% \begin{list}{}
%      \item\CIRCLE{} Tom Mitchell
%      \item\Circle{} Marie Curie
%      \item\Circle{} Noam Chomsky
% \end{list}
% \end{quote}

For questions where you must fill in a blank, please make sure your final answer is fully included in the given space.  \textbf{Do not change the size of the box provided.}  For short answer questions you should \textbf{not} include your work in your solution.  Only provide an explanation or proof if specifically asked.  Otherwise, your assignment may not be graded correctly, and points may be deducted from your assignment.

\begin{quote}
\textbf{Fill in the blank:} What is the course number?

\begin{tcolorbox}[fit,height=1cm, width=4cm, blank, borderline={1pt}{-2pt},nobeforeafter]
    \begin{center}\huge10-703\end{center}
    \end{tcolorbox}
\end{quote}


\newpage
\section*{Question 1 Convolutional Neural Network}
\subsection*{Question 1.a}
    \qquad 
    \textbf{y} =  \begin{tcolorbox}[fit,height=1cm, width=6cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            [4, -3]
            \end{center}
            \end{tcolorbox}
\subsection*{Question 1.b}
\begin{enumerate}
        \item{loss value using original weights: }
            \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            37
            \end{center}
            \end{tcolorbox} \vspace{0.8cm} \\
        \item{new weights} 
            \begin{tcolorbox}[fit,height=1cm, width=9cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            [0.72, 0.34, -.84]
            \end{center}
            \end{tcolorbox}
            \vspace{0.8cm} \\
        \item{output using new weights}
            \begin{tcolorbox}[fit,height=1cm, width=6cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            [3.36, -1.36]
            \end{center}
            \end{tcolorbox}
            \vspace{0.8cm} \\
        \item{loss using new weights}
            \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            19.1392
            \end{center}
            \end{tcolorbox}
\end{enumerate}

\newpage
\section*{Question 2 Policy Iteration and Value Iteration}
    \begin{tcolorbox}[fit,height=8cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    TODO: Policy iteration and Value Iteration algorithms have guaranteed convergence due critically to the Gamma contraction property of the tabular Bellman update operation. In other words, in finite MDPs, a Bellman update operation on any value function will monotonically improve the value function, which in turn can be used to create an improved policy. However, if a function approximator for V($s$) or Q($s,a$) is used instead of this finite tabular representation with proven convergence, then we lose the Gamma contraction property of the approximator updates. This is because a Bellman operation is not performed on the function approximator (as it is continuous), and therefore the updates cannot be guaranteed to strictly improve the Value or Q-value functions' continuous representations.
    \end{tcolorbox}
\newpage
\section*{Question 3 Continuation Function}
\subsection*{Question 3.a}
\begin{enumerate}
    \item{Derive the recurrence relation} \vspace{4pt} \\
    \begin{tcolorbox}[fit,height=12cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    \begin{align}
    C(s_1,a_1) & = \gamma\sum_{s_2}T(s_1,a_1,s_2)\cdot V(s_2)\\
    & =  \gamma\sum_{s_2}T(s_1,a_1,s_2) \cdot max_{a_2} ( R(s_2, a_2) + C(s_2, a_2))
    \end{align}
    (2) follows (1) as we can show that:
    \begin{align}
    V(s_2) & = \max_{a_2} \left( R(s_2,a_2) + \gamma \sum_{s_3}T(s_2, a_2, s_3)V(s_3) \right)\\
    & = \max_{a_2} \left( R(s_2,a_2) + C(s_2,a_2) \right)
    \end{align}

    \end{tcolorbox}
   \item{Fill in the table} \vspace{4pt} \\
   \begin{enumerate}[label=\roman*)]
        \item \qquad
            \begin{tcolorbox}[fit,height=3cm, width=12cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            $$ V(s) = max_{a} (R(s,a) + C(s,a))$$
            \end{center}
            \end{tcolorbox}
        \item \qquad
            \begin{tcolorbox}[fit,height=3cm, width=12cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            $$ Q(s, a) = R(s,a) + \gamma\sum_{s'}T(s,a,s')\cdot V(s') $$
            \end{center}
            \end{tcolorbox}
        \item \qquad
        \begin{tcolorbox}[fit,height=3cm, width=12cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            $$ Q(s,a) = R(s,a) + C(s,a) $$
            \end{center}
            \end{tcolorbox}
        \item \qquad
            \begin{tcolorbox}[fit,height=3cm, width=12cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            $$ C(s,a) = \gamma\sum_{s'}T(s,a,s')max_{a'}Q(s',a') $$
            \end{center}
            \end{tcolorbox}
    \end{enumerate}
\end{enumerate}
\subsection*{Question 3.b}
\begin{enumerate}
    \item 
    \begin{tcolorbox}[fit,height=4cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    True, knowing $Q(s,a)$ is better than knowing $V(s)$ if we don't know $T, R$ because $Q(s,a)$ captures all necessary information from $T$ and $R$, and choosing optimal actions' values from $Q(s,a)$ can be used to compute $V(s)$ like: $V(s) = max_aQ(s,a)$.
    \end{tcolorbox}
    \item 
    \begin{tcolorbox}[fit,height=4cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    False, knowing $C(s,a)$ is better because it captures $T$ whereas $V(s)$ still needs $T$ to compute state values and that information about $T$ is lacking. $V(s)$ can be computed using only $V(s) = max_a ( R(s,a) + C(s,a))$.
    \end{tcolorbox}
\end{enumerate}


\newpage
\section*{Question 4 Importance Sampling}
\begin{enumerate}
     \item 
        Expectation: \begin{tcolorbox}[fit,height=1cm, width=3cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox} \vspace{5mm}\\
        Variance: \hspace{0.47cm} \begin{tcolorbox}[fit,height=1cm, width=3cm, blank, borderline={1pt}{1pt},nobeforeafter]
            \begin{center}
            \vspace{3mm}
            %solution
            \end{center}
            \end{tcolorbox}  
    \item Direct Sampling \vspace{0.3cm} \\
    \begin{tcolorbox}[fit,height=10cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    %solution
    \end{tcolorbox}
    \newpage 
    \item Importance Sampling \vspace{0.3cm} \\
    \begin{tcolorbox}[fit,height=10cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    %solution
    \end{tcolorbox}
    
    \item Weighted Importance Sampling \vspace{0.3cm}\\
    \begin{tcolorbox}[fit,height=10cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    %solution
    \end{tcolorbox}
\end{enumerate}
\newpage 
\section*{Question 5 MC and TD Methods}
\begin{enumerate}
    \item 
        S0: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S1: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S2: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S3: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox} \vspace{0.8cm} \\
        S4: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S5: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S6: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        \vspace{1cm}
    \item 
        S0: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S1: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S2: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S3: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox} \vspace{0.8cm} \\
        S4: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S5: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S6: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        \vspace{1cm}
    \item 
        S0: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S1: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S2: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S3: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox} \vspace{0.8cm} \\

        S4: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S5: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
        S6: \begin{tcolorbox}[fit,height=1cm, width=2cm, blank, borderline={1pt}{1pt},nobeforeafter]
        \begin{center}
        \vspace{3mm}
        %solution
        \end{center}
        \end{tcolorbox}
        \qquad
\end{enumerate}

\newpage
\section*{Question 6 Programming Question}
    \begin{tcolorbox}[fit,height=22cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    %solution
    \end{tcolorbox}
    \begin{tcolorbox}[fit,height=22cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    %solution
    \end{tcolorbox}
    \begin{tcolorbox}[fit,height=22cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    %solution
    \end{tcolorbox}
    \begin{tcolorbox}[fit,height=22cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    %solution
    \end{tcolorbox}
    \begin{tcolorbox}[fit,height=22cm, width=\textwidth, blank, borderline={1pt}{-2pt},nobeforeafter]
    %solution
    \end{tcolorbox}
\end{document}
